---
import type { CalEventType } from '@app/data/cal/event-types';
import bookingTilesClientUrl from '@app/features/bookme/ui/booking-tiles-client.ts?url';
const { locale, events } = Astro.props as { locale: 'en'|'ru'; events: CalEventType[] };
---

<div class="booker-row-3">
  {events.map(ev => (
    <button
      type="button"
      class="booking-tile w-full group rounded-2xl border p-4 text-left hover:shadow focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2"
      data-inline-link={ev.calLink}
      data-inline-config='{"hideEventTypeDetails":true}'
      aria-pressed="false"
      aria-label={(ev.i18n[locale]?.title) + ' — ' + (ev.i18n[locale]?.subtitle || '')}
    >
      <div class="text-lg font-semibold">{ev.i18n[locale].title}</div>
      {ev.i18n[locale].subtitle && <div class="text-sm opacity-70">{ev.i18n[locale].subtitle}</div>}
      <div class="mt-4 inline-flex items-center gap-2 text-sm opacity-90">
        <span>{ev.i18n[locale].cta || (locale === 'ru' ? 'Записаться' : 'Book')}</span>
        <span aria-hidden="true">→</span>
      </div>
    </button>
  ))}
</div>

<style>
  /* Active state for selected tiles */
  .booking-tile.active {
    outline: 2px solid var(--cv-accent);
    outline-offset: -2px;
    background: rgba(79, 70, 229, 0.05);
    border-color: var(--cv-accent);
  }

  /* Dark theme active state */
  :global(.dark) .booking-tile.active {
    background: rgba(79, 70, 229, 0.1);
    border-color: var(--cv-accent);
  }

  /* Loading state for cal-inline */
  :global(#cal-inline.is-loading) {
    opacity: 0.7;
    transition: opacity 0.3s ease;
  }
</style>

<script type="module" src={bookingTilesClientUrl}></script>
