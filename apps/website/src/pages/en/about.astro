---
import AppShell from '../../app/layouts/AppShell.astro';
import AboutShell from '../../features/about/ui/AboutShell.astro';
import { getDevscardData } from '../../features/about/devscard/lib/getDevscardData';
import { getAbout } from '../../shared/content/about';
import { toDevscardMainSection } from '../../shared/content/adapters';
import CmsOptional from '@app/content/ui/CmsOptional.astro';
import Footer from '../../app/widgets/footer/ui/Footer.astro';

const locale = 'en';
const devscardData = getDevscardData(locale);
const aboutData = await getAbout(locale);

// Convert CMS data to Devs Card format
const cmsMainSection = toDevscardMainSection(aboutData, locale);
const enhancedDevscardData = {
  ...devscardData,
  sections: {
    ...devscardData.sections,
    main: cmsMainSection,
  }
};
---

<AppShell variant="about">
  <CmsOptional lang={locale} route="/en/about">
    <AboutShell locale={locale} data={enhancedDevscardData} />
  </CmsOptional>
</AppShell>

<style>
  html {
    scroll-behavior: smooth;
  }

  /* Ensure proper spacing for sticky navbar */
  body {
    margin: 0;
    padding: 0;
  }
</style>

<script>
  // Redirect from #bookme to /bookme page
  if (typeof window !== 'undefined' && location.hash === '#bookme') {
    location.replace('/en/bookme');
  }
</script>

<Footer />
