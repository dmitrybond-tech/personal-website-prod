---
import LanguageToggle from '@shared/ui/LanguageToggle/LanguageToggle.astro';
import { getLocaleFromPath, swapLocale } from '@shared/config/i18n';

interface Props {
  locale: 'en' | 'ru';
}

type Locale = 'en' | 'ru';

// Получаем локаль из пропсов
const { locale } = Astro.props;

// Локализованные лейблы (явно заданы для UTF-8)
const L = {
  en: { about: 'About', book: 'Book Me', brand: 'Dmitry B.' },
  ru: { about: 'Обо мне', book: 'Записаться', brand: 'Дмитрий Б.' },
}[locale];
---

<style>
  .nav-wrap {
    position: sticky; top: 0; z-index: 50;
    background: var(--cv-page-bg);
    padding: 12px 0;
  }
  
  .nav-island {
    margin: 0 auto;
    max-width: var(--cv-max-w);
    padding: 0 var(--cv-gap);
    display: grid;
    grid-template-columns: 1fr auto 1fr;
    align-items: center;
    gap: 8px;

    background: rgba(255,255,255,.85);
    backdrop-filter: blur(8px);
    border: 1px solid rgba(0,0,0,.06);
    border-radius: 16px;         /* скругление */
    box-shadow: 0 6px 20px rgba(0,0,0,.06); /* лёгкая тень */
    padding: 10px 14px;
  }
  .brand { 
    justify-self: start; 
    font-weight: 600; 
    opacity:.85; 
    text-decoration: none;
    color: #001111;
    transition: opacity .2s ease;
  }
  .brand:hover {
    opacity: 1;
  }
  .center-nav {
    justify-self: center;
    display: inline-flex; gap: 8px;
    border: 1px solid rgba(0,0,0,.08);
    background: rgba(255,255,255,.7);
    border-radius: 999px; padding: 4px;
  }
  .nav-btn { 
    padding: 6px 14px; 
    border-radius: 999px; 
    text-decoration:none; 
    color:#001111; 
    transition: background .2s ease;
  }
  .nav-btn:hover { 
    background: rgba(0,0,0,.04); 
  }
  .right { 
    justify-self: end; 
  }
  .nav-island a { 
    text-decoration: none; 
    color: inherit; 
  }
</style>

<header class="nav-wrap" data-app-navbar>
  <div class="nav-island">
    <div class="brand">
      <a href={`/${locale}/about`}>{L.brand}</a>
    </div>
    <nav class="center-nav">
      <a class="nav-btn" href={`/${locale}/about`}>{L.about}</a>
      <a class="nav-btn" href={`/${locale}/bookme`}>{L.book}</a>
    </nav>
    <div class="right">
      <LanguageToggle locale={locale} />
    </div>
  </div>
</header>

<script>
  const el = document.querySelector('header[data-app-navbar]');
  const set = () => {
    const h = el?.offsetHeight || 72;
    document.documentElement.style.setProperty('--navbar-h', h + 'px');
  };
  set();
  new ResizeObserver(set).observe(el);
</script>