---
import { switchLocaleHref, getOppositeLocale, getLocaleDisplayName, getLocaleFlag } from '@shared/i18n/switch';

interface Props { 
  locale: 'en' | 'ru' 
}

const { locale } = Astro.props;

// Use the new language switcher utility
const targetLocale = getOppositeLocale(locale);
const targetHref = switchLocaleHref(Astro.url.pathname, targetLocale);
const label = getLocaleDisplayName(locale);
const flag = getLocaleFlag(locale);
---

<style>
  .lang-switch {
    display: inline-flex; 
    align-items: center;
    border: 1px solid var(--cv-nav-border);
    background: var(--cv-nav-bar);
    backdrop-filter: blur(6px);
    border-radius: 999px; 
    padding: 6px 14px;
    font-size: .9rem; 
    color: var(--cv-nav-text); 
    text-decoration: none;
    transition: background .2s ease, transform .05s ease;
  }
  .lang-switch:hover { 
    background: var(--cv-nav-accent);
    color: var(--cv-nav-accent-text);
  }
  .lang-switch:active { 
    transform: translateY(1px); 
  }
  
  .flag {
    margin-right: 6px;
    font-size: 1rem;
  }
  
  .label {
    font-weight: 500;
  }
</style>

<a class="lang-switch ui-outline ui-outline-brandlight" href={targetHref} aria-label={`Switch to ${getLocaleDisplayName(targetLocale)}`}>
  <span class="flag">{flag}</span>
  <span class="label">{label}</span>
</a>
